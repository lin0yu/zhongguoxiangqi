# 中国象棋（内网单机版）

## 使用方式
- 在 Windows 内网环境下，直接双击 `index.html` 打开即可运行，无需联网。
- 推荐通过本地静态服务器打开（如 Python `http.server`），以获得更佳的本地预览体验。

## 功能简介
- 标准中国象棋规则：
  - 棋子走法与吃子规则（车/马/相/士/帅/炮/兵）
  - “飞将”禁止：两帅不可同列直视
  - 将军与将死判断；无被将且无合法着法视为僵局
- 双人对战：同一设备轮流走子，支持悔棋/重做
- 图形界面：Canvas 绘制棋盘与棋子，采用传统样式与楚河汉界
- 状态保存/读取：
  - 支持保存到浏览器本地存储
  - 支持导出 JSON 文件与从 JSON 导入

## 交互说明
- 点击己方棋子以选中，再点击高亮点完成走子。
- 右侧面板提供新局、悔棋/重做与存档操作。
- 日志面板会输出关键步骤与错误信息。

## 技术实现
- 前端：HTML5 + CSS3 + JavaScript（原生）
- 绘制：Canvas
- 核心模块分层：
  - `config.js` 配置管理（尺寸、颜色、字体、存储键）
  - `logger.js` 日志模块（控制台 + 面板输出）
  - `utils.js` 通用工具（坐标与路径判断）
  - `model.js` 数据模型（棋子与棋盘）
  - `rules.js` 规则引擎（走法合法性、飞将、将/将死）
  - `engine.js` 对局引擎（走子、悔棋/重做、状态计算）
  - `render.js` 渲染层（棋盘与棋子绘制、响应式）
  - `storage.js` 存储（localStorage 与 JSON 文件）

## 复杂算法思路说明
- 走子合法性：
  1. 按棋子几何走法与阻挡规则初步判定（如马腿、炮隔子、相眼等）
  2. 克隆棋盘模拟该走子，判定是否出现“飞将”或己方被将
  3. 仅在上述两项均合法时，才视为完整合法走子
- 将军判断：定位当前方帅位置，遍历对方全体棋子，使用几何走法判断是否可直接吃到该位置
- 将死判断：在被将状态下枚举全体合法走子，若为空则将死；若不被将且无合法走子则僵局

## 内网部署
- 方式一：直接打开 `index.html`
- 方式二：使用简单静态服务器（如 `python -m http.server`）在目录下启动，即可在浏览器访问 `http://localhost:8000/`

## 质量保障
- 函数级注释与关键逻辑说明已添加
- 日志记录关键步骤与错误处理，便于排查
- 模块化设计、合理命名、避免重复逻辑，便于维护与扩展